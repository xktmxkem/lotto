import streamlit as st
import pandas as pd
import random

st.set_page_config(page_title="ì—‘ì…€ ë‹¹ì²¨ì ì¶”ì²¨ê¸°", layout="centered")

st.title("ğŸ‰ ì—‘ì…€ ë‹¹ì²¨ì ì¶”ì²¨ê¸°")

# ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ
uploaded_file = st.file_uploader("ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”", type=["xlsx", "xls"])

if uploaded_file is not None:
    # ë°ì´í„° ì½ê¸°
    df = pd.read_excel(uploaded_file)

    st.subheader("ğŸ“„ ì—…ë¡œë“œëœ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°")
    st.dataframe(df.head())

    # ì¶”ì²¨ ì¸ì› ì…ë ¥
    num_winners = st.number_input("ë‹¹ì²¨ì ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”", min_value=1, max_value=len(df), value=1, step=1)

    if st.button("ì¶”ì²¨í•˜ê¸°"):
        winners = df.sample(n=num_winners, random_state=random.randint(0, 10000))

        st.subheader("ğŸ† ë‹¹ì²¨ì ëª…ë‹¨")
        st.dataframe(winners)

        # CSV ë‹¤ìš´ë¡œë“œ ë²„íŠ¼
        csv = winners.to_csv(index=False).encode("utf-8-sig")
        st.download_button(
            label="ğŸ“¥ ë‹¹ì²¨ì ëª…ë‹¨ ë‹¤ìš´ë¡œë“œ (CSV)",
            data=csv,
            file_name="winners.csv",
            mime="text/csv",
        )
